!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.Rev=t(e.React)}(this,function(e){"use strict";var t="default"in e?e.default:e;function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var a=new(function(){function e(){n(this,e),i(this,"_subscribers",[])}return o(e,[{key:"subscribe",value:function(e){var t=this._subscribers;return t.indexOf(e)<0&&t.push(e),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}},{key:"publish",value:function(e,t){this._subscribers.forEach(function(n){return n(e,t)})}}]),e}());function l(r){var l=r.state,p=r.dispatch,b=r.mapStateToProps,h=r.Components;return function(r){function y(){var e,t,r,o;n(this,y);for(var s=arguments.length,a=new Array(s),p=0;p<s;p++)a[p]=arguments[p];return r=this,t=!(o=(e=c(y)).call.apply(e,[this].concat(a)))||"object"!=typeof o&&"function"!=typeof o?f(r):o,i(f(f(t)),"state",u({},l)),i(f(f(t)),"_isMounted",!1),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(y,e.Component),o(y,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.subscribe()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.unsubscribe()}},{key:"subscribe",value:function(){var e=this,t=a.subscribe(function(t,n){console.log(t,n),e._isMounted&&e.setState(function(e){return e===n?null:u({},n)})});this.unsubscribe=t}},{key:"render",value:function(){var e=u({dispatch:p},b(this.state));return t.createElement(h,e)}}]),y}()}return{connect:function(e,t){var n=t.state,r=t.reducers,o=t.effects;return function(t){return l({state:n,dispatch:function e(t){var i=t.type;if(i in r){var u=r[i](n,t);a.publish(t,u)}if(i in o){var c=o[i](t,{dispatch:e});a.publish(t,c)}return t},mapStateToProps:e,Components:t})}}}});
