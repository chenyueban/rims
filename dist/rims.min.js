!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("immer")):"function"==typeof define&&define.amd?define(["react","immer"],e):t.Rims=e(t.React,t.produce)}(this,function(t,e){"use strict";var n="default"in t?t.default:t;function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e=e&&e.hasOwnProperty("default")?e.default:e;var s=new(function(){function t(){r(this,t),u(this,"_subscribers",[])}return i(t,[{key:"subscribe",value:function(t){var e=this._subscribers;return e.indexOf(t)<0&&e.push(t),function(){var n=e.indexOf(t);n>-1&&e.splice(n,1)}}},{key:"publish",value:function(t,e){this._subscribers.forEach(function(n){return n(t,e)})}}]),t}()),p=Array.isArray,l=Object.keys,b=Object.prototype.hasOwnProperty,y=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){var r,o,i,u=p(e),c=p(n);if(u&&c){if((o=e.length)!=n.length)return!1;for(r=o;0!=r--;)if(!t(e[r],n[r]))return!1;return!0}if(u!=c)return!1;var f=e instanceof Date,a=n instanceof Date;if(f!=a)return!1;if(f&&a)return e.getTime()==n.getTime();var s=e instanceof RegExp,y=n instanceof RegExp;if(s!=y)return!1;if(s&&y)return e.toString()==n.toString();var h=l(e);if((o=h.length)!==l(n).length)return!1;for(r=o;0!=r--;)if(!b.call(n,h[r]))return!1;for(r=o;0!=r--;)if(!t(e[i=h[r]],n[i]))return!1;return!0}return e!=e&&n!=n};function h(o){var p=o.state,l=o.dispatch,b=o.mapStateToProps,h=o.Components;return function(o){function d(){var t,e,n,o;r(this,d);for(var i=arguments.length,f=new Array(i),s=0;s<i;s++)f[s]=arguments[s];return n=this,e=!(o=(t=c(d)).call.apply(t,[this].concat(f)))||"object"!=typeof o&&"function"!=typeof o?a(n):o,u(a(a(e)),"state",{storeState:p}),u(a(a(e)),"_isMounted",!1),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(d,t.Component),i(d,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.subscribe()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.unsubscribe()}},{key:"subscribe",value:function(){var t=this,n=s.subscribe(function(n,r){if(t._isMounted){var o=e(t.state,function(t){t.storeState=r});y(o,t.state)||t.setState(o)}});this.unsubscribe=n}},{key:"render",value:function(){var t=this.state.storeState,e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){u(t,e,n[e])})}return t}({dispatch:l},b(t));return n.createElement(h,e)}}]),d}()}return{connect:function(t,e){var n=e.state,r=e.reducers,o=e.effects;return function(e){return h({state:n,dispatch:function t(e){var i=e.type;if(i in r){var u=r[i](n,e);s.publish(e,u)}return i in o&&o[i]({dispatch:t},e),e},mapStateToProps:t,Components:e})}}}});
